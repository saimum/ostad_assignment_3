name: "CI-CD for node js app"

on:
 push:
  branches:
   - main
   
jobs:
 test_job:
  name: "job_1: test_job"
  runs-on: ubuntu-latest
  steps:
   - name : "check out code"
     uses: actions/checkout@v3
     
   - name: "install node js 22"
     uses: actions/setup-node@v4
     with:
      node-version: '22'
   
   - name: "node dependency Install"
     run: npm install
     
#   - name: "Run test & store log"
#     run: |
#      mkdir -p test-results
#      npm check > test-results/results.txt || echo "Test failed"
   - name: "run test and store result"
     run: npm run check > test_result.txt
      
   - name: "upload test result in artifact"
     uses: actions/upload-artifact@v4
     with:
      name: test_result
      path: test_result.txt
      
   - name: Download artifact
     uses: actions/download-artifact@v4
     with:
          name: test_result # Download the artifact by its name
                  
   - name: "show result"
     run: cat test_result.txt
     
# deploy_job:
#  name: "job_2: deploy_job"
#  runs-on: ubuntu-latest
#  needs: test_job
#  steps:
#   - name : "check out code"
#     uses: actions/checkout@v3
#     
#   - name: "Download artifact"
#     uses: actions/upload-artifact@v3
#     with:
#      name: test-results
#      path: test-results/results.txt














      